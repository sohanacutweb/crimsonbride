function fla_amron_module(){function r(){this._device=function(){var a=window,b=a.navigator.userAgent,e={ios:!1,android:!1,androidChrome:!1,desktop:!1,windows:!1,iphone:!1,ipod:!1,ipad:!1,cordova:a.cordova||a.phonegap,phonegap:a.cordova||a.phonegap},d=b.match(/(Windows Phone);?[\s\/]+([\d.]+)?/),f=b.match(/(Android);?[\s\/]+([\d.]+)?/),l=b.match(/(iPad).*OS\s([\d_]+)/),g=b.match(/(iPod)(.*OS\s([\d_]+))?/),h=!l&&b.match(/(iPhone\sOS|iOS)\s([\d_]+)/);d&&(e.os="windows",e.osVersion=d[2],e.windows=!0);
f&&!d&&(e.os="android",e.osVersion=f[2],e.android=!0,e.androidChrome=0<=b.toLowerCase().indexOf("chrome"));if(l||h||g)e.os="ios",e.ios=!0;h&&!g&&(e.osVersion=h[2].replace(/_/g,"."),e.iphone=!0);l&&(e.osVersion=l[2].replace(/_/g,"."),e.ipad=!0);g&&(e.osVersion=g[3]?g[3].replace(/_/g,"."):null,e.iphone=!0);e.ios&&e.osVersion&&0<=b.indexOf("Version/")&&"10"===e.osVersion.split(".")[0]&&(e.osVersion=b.toLowerCase().split("version/")[1].split(" ")[0]);e.desktop=!(e.os||e.android||e.webView);e.webView=
(h||l||g)&&b.match(/.*AppleWebKit(?!.*Safari)/i);e.os&&"ios"===e.os&&(b=e.osVersion.split("."),d=document.querySelector('meta[name="viewport"]'),e.minimalUi=!e.webView&&(g||h)&&(7===1*b[0]?1<=1*b[1]:7<1*b[0])&&d&&0<=d.getAttribute("content").indexOf("minimal-ui"));e.pixelRatio=a.devicePixelRatio||1;return e}();this._mouseDetected=!1;var a=function(c){window.removeEventListener("mousedown",a,!1);window.removeEventListener("touchstart",a,!1);"touchstart"==c.type?(c.stopPropagation(),this._mouseDetected=
!1):this._mouseDetected=!0};window.addEventListener("mousedown",a,!1);window.addEventListener("touchstart",a,!1);this.cacherItemsList=this.CacheItemsList()}function t(a){this.delegate=a;this.appName=a.appName;this.id=this.appName+"_tag_";this.view=document.createElement("div");this.view.className="fla_amron_CollectionTagsCloud";this.list=document.createElement("ul");this.view.appendChild(this.list)}function u(a,c){this.delegate=a;this.appName=a.appName;this.index=c;this.view=document.createElement("div");
this.view.className="fla_amron_MasonryThumbPint";this.view.style.padding=d(this.appName).thumbSpacing/2+"px";this.imageHolder=document.createElement("div");this.imageHolder.className="fla_imageHolder";this.view.appendChild(this.imageHolder);this._size=h.Size(1,1);this.item=void 0;this.imageRetio=1;this.opacityDelay=void 0;this._display="none"}function p(a,c){this.delegate=a;this.appName=c;this.properties=void 0;this.itemsList=[];this.filteredList=[];this.presentedList=[];this.page_Amount=0;this.scrollHandler=
this.cureantPage=void 0;this.terms=[];this.term=void 0;this.tagsCloud=d(this.appName).tagsFilter?[{name:d(this.appName).tagCloudAll,id:0}]:void 0;this._filter=0;this.view=document.createElement("div");this.header=document.createElement("div");this.headerNavi=document.createElement("div");this.content=document.createElement("div");this.footer=document.createElement("div");this.tagsCloudView=void 0;this.header.className="gm_header";this.content.className="gm_content";this.footer.className="gm_footer";
this.headerNavi.classList="gm_navi";this.header.appendChild(this.headerNavi);this.view.appendChild(this.header);this.view.appendChild(this.content);this.view.appendChild(this.footer);this.resizeTimeOut=void 0;this.viewWidth=0}function q(a,c){p.apply(this,arguments);this.view.className="fla_amron_MasonryCollection";this.header.style.padding="0 "+d(c).thumbSpacing/2+"px";this.content.style.paddingBottom=d(c).thumbSpacing+"px";this.columnsArr=[]}function v(a,c,b){h.copyProperties(a,this);FlaGallery&&
(this.appName=c,this.appDiv=b,this.modal=void 0,a=this.settings,d(this.appName).appEventManager=h.GMEventsManager(),a&&(d(this.appName).lightBoxEnable="1"==a.lightBoxEnable?!0:!1,d(this.appName).thumbSpacing=parseInt(a.thumbSpacing),d(this.appName).collectionPreloaderColor=a.collectionPreloaderColor,d(this.appName).linkTargetWindow=a.linkTargetWindow,d(this.appName).infoBarTermsClickNewPageEnable="1"==a.infoBarTermsClickNewPageEnable?!0:!1,d(this.appName).tagsFilter="1"==a.tagsFilter?!0:!1,d(this.appName).tagCloudAll=
a.tagCloudAll,d(this.appName).tagCloudTextColor=a.tagCloudTextColor,d(this.appName).tagCloudBgColor=a.tagCloudBgColor,d(this.appName).collectionThumbRecomendedWidth=parseInt(a.collectionThumbRecomendedWidth),d(this.appName).collectionThumbHoverColor=a.collectionThumbHoverColor,d(this.appName).collectionThumbContentBGColor="rgba(245,245,245,1)",d(this.appName).collectionThumbTitleShow="1"==a.collectionThumbTitleShow?!0:!1,d(this.appName).collectionThumbTitleColor=a.collectionThumbTitleColor,d(this.appName).collectionThumbFontSize=
parseInt(a.collectionThumbFontSize),d(this.appName).collectionThumbDescriptionShow="1"==a.collectionThumbDescriptionShow?!0:!1,d(this.appName).collectionThumbDescriptionColor=a.collectionThumbDescriptionColor,d(this.appName).collectionThumbDescriptionFontSize=parseInt(a.collectionThumbDescriptionFontSize),d(this.appName).collectionThumbSubMenuBackgroundColor=a.collectionThumbSubMenuBackgroundColor,d(this.appName).collectionThumbSubMenuBackgroundColorOver=a.collectionThumbSubMenuBackgroundColorOver,
d(this.appName).collectionThumbSubMenuIconColor=a.collectionThumbSubMenuIconColor,d(this.appName).collectionThumbSubMenuIconHoverColor=a.collectionThumbSubMenuIconHoverColor,d(this.appName).collectionReadMoreButtonBGColor=a.collectionReadMoreButtonBGColor,d(this.appName).collectionReadMoreButtonLabelColor=a.collectionReadMoreButtonLabelColor,d(this.appName).collectionReadMoreButtonBGColorHover=a.collectionReadMoreButtonBGColorHover,d(this.appName).collectionReadMoreButtonLabelColorHover=a.collectionReadMoreButtonLabelColorHover,
d(this.appName).collectionReadMoreButtonLabel=a.collectionReadMoreButtonLabel,d(this.appName).modaBgColor=a.modaBgColor,d(this.appName).modalInfoBoxBgColor=a.modalInfoBoxBgColor,d(this.appName).modalInfoBoxTitleTextColor=a.modalInfoBoxTitleTextColor,d(this.appName).modalInfoBoxTextColor=a.modalInfoBoxTextColor,d(this.appName).infoBarCountersEnable="1"==a.infoBarCountersEnable?!0:!1,d(this.appName).infoBarDateInfoEnable="1"==a.infoBarDateInfoEnable?!0:!1,d(this.appName).shareTitlePlaceHolder=a.shareTitlePlaceHolder,
d(this.appName).sliderThumbBarEnable=!1,d(this.appName).sliderThumbBarHoverColor="black",d(this.appName).sliderPreloaderColor=a.sliderPreloaderColor,d(this.appName).sliderBgColor=a.sliderBgColor,d(this.appName).sliderHeaderFooterBgColor=a.sliderHeaderFooterBgColor,d(this.appName).sliderNavigationColor=a.sliderNavigationColor,d(this.appName).sliderNavigationIconColor=a.sliderNavigationIconColor,d(this.appName).sliderItemTitleFontSize=parseInt(a.sliderItemTitleFontSize),d(this.appName).sliderItemTitleTextColor=
a.sliderItemTitleTextColor,d(this.appName).sliderThumbSubMenuBackgroundColor=a.sliderThumbSubMenuBackgroundColor,d(this.appName).sliderThumbSubMenuBackgroundColorOver=a.sliderThumbSubMenuBackgroundColorOver,d(this.appName).sliderThumbSubMenuIconColor=a.sliderThumbSubMenuIconColor,d(this.appName).sliderThumbSubMenuIconHoverColor=a.sliderThumbSubMenuIconHoverColor,d(this.appName).sliderInfoEnable="1"==a.sliderInfoEnable?!0:!1,d(this.appName).sliderItemDownload="1"==a.sliderItemDownload?!0:!1,d(this.appName).sliderItemDiscuss=
"1"==a.sliderItemDiscuss?!0:!1,d(this.appName).sliderSocialShareEnabled="1"==a.sliderSocialShareEnabled?!0:!1,d(this.appName).sliderLikesEnabled="1"==a.sliderLikesEnabled?!0:!1),d&&(this.terms={},this.collection=void 0,this.gallery=[],this.appDiv.style.position="relative",this.appDiv.style.height="auto",this.appDivWidth=this.appDiv.clientWidth,this.collection=new q(this,this.appName),this.appDiv.appendChild(this.collection.view),this.collection.init(),d(this.appName).appEventManager.addGMEventListener(m.EXT_SCRIPTS_READY,
this,"modulesReady"),h.loadExtScripts(w,this,m.EXT_SCRIPTS_READY)))}r.prototype={moduleSettings:function(a){return window[a]&&window[a].settings?window[a].settings:null},get passiveListener(){return this.isPassiveListener()?{passive:!1,capture:!1}:!1},isPassiveListener:function(){var a=!1;try{var c=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("testPassiveListener",null,c)}catch(b){}return a},get requestAnimationFrame(){return window.requestAnimationFrame||window.mozRequestAnimationFrame||
window.webkitRequestAnimationFrame||window.msRequestAnimationFrame},get cancelAnimationFrame(){return window.cancelAnimationFrame||window.mozCancelAnimationFrame},get whichTransitionEventEnd(){var a,c=document.createElement("fakeelement"),b={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(a in b)if(void 0!==c.style[a])return b[a]},get Device(){return this._device},get is_touch_device(){return navigator.maxTouchPoints||
"ontouchstart"in window},get getScrollbarWidth(){var a=document.createElement("div");a.style.visibility="hidden";a.style.width="100px";a.style.msOverflowStyle="scrollbar";document.body.appendChild(a);var c=a.offsetWidth;a.style.overflow="scroll";var b=document.createElement("div");b.style.width="100%";a.appendChild(b);b=b.offsetWidth;a.parentNode.removeChild(a);return c-b},get hasScrollbar(){if("number"===typeof window.innerWidth)return window.innerWidth>document.documentElement.clientWidth;var a=
document.documentElement||document.body;if("undefined"!==typeof a.currentStyle)var c=a.currentStyle.overflow;c=c||window.getComputedStyle(a,"").overflow;if("undefined"!==typeof a.currentStyle)var b=a.currentStyle.overflowY;b=b||window.getComputedStyle(a,"").overflowY;a=a.scrollHeight>a.clientHeight;var e=/^(visible|auto)$/.test(c)||/^(visible|auto)$/.test(b);return a&&e||"scroll"===c||"scroll"===b},get miniScreen(){return 500>window.screen.height||500>window.screen.width},get mouseDetected(){return this._mouseDetected},
get youTubeCode(){return'<iframe src="https://www.youtube.com/embed/%id%?rel=0&showinfo=0&autoplay=1&wmode=transparent" frameborder="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},get vimeoCode(){return'<iframe src="https://player.vimeo.com/video/%id%?byline=0&portrait=0&autoplay=1" frameborder="no" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'},copyProperties:function(a,c){for(var b in a)c[b]=a[b]},shuffle:function(a){for(var c=a.length,b,e;0!==c;)e=
Math.floor(Math.random()*c),--c,b=a[c],a[c]=a[e],a[e]=b;return a},Rect:function(a,c,b,e){return{x:a,y:c,width:b,height:e}},Size:function(a,c){return{width:a,height:c}},Point:function(a,c){return{x:a,y:c}},findHighestZIndex:function(a){for(var c=99999,b=0;b<a.childNodes.length;b++){var e=a.childNodes[b];if(1==e.nodeType&&"SCRIPT"!=e.nodeName)var d=document.defaultView.getComputedStyle(e,null).getPropertyValue("z-index");d>c&&"auto"!=d&&(c=parseInt(d))}return c},timeConverter:function(a){a=new Date(1E3*
a);var c=new Date,b=new Date(Date.now()-864E5),e=a.getFullYear(),d="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")[a.getMonth()],f=a.getDate(),l=a.getHours(),g=a.getMinutes();return a.setHours(0,0,0,0)==c.setHours(0,0,0,0)?"Today, "+l+":"+g:a.setHours(0,0,0,0)==b.setHours(0,0,0,0)?"Yesterday, "+l+":"+g:e==c.getFullYear()?f+" "+d+", "+e:f+" "+d+" "+e},createPreloaderView:function(a){var c=0,b=document.createElement("div");b.className="fla_v2_Preloader";var e=document.createElement("div");
e.style.position="absolute";e.style.width="8px";e.style.height="8px";e.style.margin="-4px";e.style.left="50%";e.style.top="50%";e.style.borderRadius="50%";e.style.backgroundColor=a;b.appendChild(e);e=document.createElement("div");e.className="c-spinner";e.style.position="absolute";e.style.width="36px";e.style.height="36px";e.style.margin="-18px";e.style.left="50%";e.style.top="50%";for(var d=0;8>d;d++){var f=document.createElement("div");f.style.position="absolute";f.style.top="50%";f.style.left=
"50%";f.style.marginTop="-4px";f.style.marginLeft="-4px";f.style.width="8px";f.style.height="8px";f.style.backgroundColor=a;f.style.borderRadius="100%";f.style.transform="rotate("+c+"deg) translate(18px)";c+=45;e.appendChild(f)}b.appendChild(e);return b},trace:function(a){if(1==arguments.length)console.log(a);else{for(var c="",b=0;b<arguments.length;b++)c+=arguments[b]+", ";c=c.slice(0,-2);console.log(c)}},preventDefaultForScrollKeys:function(a){if({37:1,38:1,39:1,40:1}[a.keyCode])return a.preventDefault(),
!1},preventDefault:function(a){a=a||window.event;a.preventDefault&&a.preventDefault();a.returnValue=!1},disableBodyScroll:function(){document.getElementsByTagName("html")[0].classList.add("fla_AlbumsListMasonry_PopUpActive")},enableBodyScroll:function(){document.getElementsByTagName("html")[0].classList.remove("fla_AlbumsListMasonry_PopUpActive")},disableBodyScrollSlider:function(){window.addEventListener&&(window.addEventListener("wheel",this.preventDefault,this.passiveListener),window.addEventListener("mousewheel",
this.preventDefault,this.passiveListener),window.addEventListener("touchmove",this.preventDefault,this.passiveListener));document.onkeydown=this.preventDefaultForScrollKeys},enableBodyScrollSlider:function(){window.removeEventListener&&(window.removeEventListener("wheel",this.preventDefault,this.passiveListener),window.removeEventListener("mousewheel",this.preventDefault,this.passiveListener),window.removeEventListener("touchmove",this.preventDefault,this.passiveListener));document.onkeydown=null},
collapseElementsInElemt:function(a,c){for(var b=[],e=0;e<a.childNodes.length;e++){var d={},f=a.childNodes[e];1==f.nodeType&&"SCRIPT"!=f.nodeName&&f!==c&&(d.element=f,d.height=null,d.overflow=null,""!=f.style.height&&(d.height=f.style.height),""!=f.style.overflow&&(d.overflow=f.style.overflow),b.push(d),f.style.overflow="hidden",f.style.height="0")}return b},recoverElements:function(a){if(0!=a.length)for(var c=0;c<a.length;c++){var b=a[c].element;b&&(a[c].overflow?b.style.overflow=a[c].overflow:b.style.removeProperty("overflow"),
a[c].height?b.style.height=a[c].height:b.style.removeProperty("height"))}},hexToRgbaStrin:function(a,c){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,c,d,f){return c+c+d+d+f+f});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?"rgba("+parseInt(a[1],16)+","+parseInt(a[2],16)+","+parseInt(a[3],16)+","+c+")":null},getFrameForBoxWithMode:function(a,c,b){var e=a.width,d=a.height;a=c.width;c=c.height;b?b=Math.max(a/e,c/d):(b=Math.min(a/e,c/d),b=1<b?1:b);e=Math.round(e*b);d=Math.round(d*
b);return this.Rect(Math.round((a-e)/2),Math.round((c-d)/2),e,d)},getItemFrameByIndexForBox:function(a,c,b,e,d,f){var k=1;f&&(k=f);d=Math.min(c,d);d=Math.floor(c/d);c=1<d?(c-(d-1)*b)/d:c;k*=c;f=Math.ceil((a+1)/d)-1;return this.Rect((a-f*d)*(c+b),f*(k+e),c,k)},fadeOut:function(a,c,b){function e(){var k=(new Date).getTime()-f,g=k/b;1>g?(g=1-d(g),a.style.opacity=String(g),setTimeout(e,Math.min(25,b-k))):(a.style.opacity="0",c&&c())}b||(b=500);var d=Math.sqrt,f=(new Date).getTime();e()},ellipsizeTextBoxToLine:function(a,
c){a.innerHTML=a.textContent||a.innerText||"";var b=a.innerHTML,e=a.innerHTML.split(" ");a.innerHTML=e[0].substring(0,3);c*=a.clientHeight;for(a.innerHTML=b;a.clientHeight>c;)e.pop(),a.innerHTML=e.join(" ")+" ..."},ellipsizeTextBox:function(a){a.innerHTML=a.textContent||a.innerText||"";for(var c=a.innerHTML.split(" ");a.scrollHeight>a.offsetHeight;)c.pop(),a.innerHTML=c.join(" ")+" ..."},scrollToY:function(a,c){var b=window.pageYOffset,e=Math.PI/(c/15),d=b/2,f=0,h,g=setInterval(function(){window.pageYOffset>
a?(f+=1,h=d-d*Math.cos(f*e),window.scrollTo(0,b-h)):clearInterval(g)},15)},toggleFullScreen:function(a){var c=document.webkitIsFullScreen||document.mozFullScreen||!1;a.requestFullScreen=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen||function(){return!1};document.cancelFullScreen=document.cancelFullScreen||document.webkitCancelFullScreen||document.mozCancelFullScreen||function(){return!1};c?document.cancelFullScreen():a.requestFullScreen()},CacheItemsList:function(){function a(){b.cached+=
1;c(b.lastIndex+1>=b.itemsList.length?0:b.lastIndex+1)}function c(e){!b.itemsList||b.cached==b.itemsList.length&&!b.amount||b.amount&&b.cached>=b.amount||(b.amount&&(b.amount=Math.min(b.amount,b.itemsList.length)),b.currentItem=b.itemsList[e].webView,b.lastIndex=e,b.currentItem.complete?(b.cached+=1,c(b.lastIndex+1>=b.itemsList.length?0:b.lastIndex+1)):b.currentItem.addEventListener("load",a,!1))}var b={cached:0,itemsList:void 0,currentItem:void 0,amount:void 0,lastIndex:void 0,init:function(e,d,
f){b.currentItem&&b.currentItem.removeEventListener("load",a,!1);b.amount=f;b.cached=0;b.currentItem=void 0;b.lastIndex=d;b.itemsList=e;void 0===d&&(d=0);c(d)},status:function(){return{list:b.itemsList,index:b.lastIndex}}};return b},GMEventsManager:function(){return{_listenerSet:{},addGMEventListener:function(a,c,b){this._listenerSet[a]||(this._listenerSet[a]=[]);this._listenerSet[a].push({listener:c,handler:b})},removeGMEventListener:function(a,c,b){if(this._listenerSet[a])for(var e=0;e<this._listenerSet[a].length;e++)this._listenerSet[a][e].listener==
c&&this._listenerSet[a][e].handler==b&&(this._listenerSet[a].splice(e,1),e=this._listenerSet[a].length)},dispatchGMEvent:function(a){if(this._listenerSet[a.type])for(var c=this._listenerSet[a.type],b=0;b<c.length;b++){var e=c[b];if(e&&e.listener&&"function"==typeof e.listener[e.handler])e.listener[e.handler](a)}}}},GMEvent:function(a,c,b){var e={};e.type=a;e.params=b;e.target=c;return e},loadExtScripts:function(a,c,b){for(var e=d(c.appName).module_url,k=0,f=0;f<a.length;f++){var l=document.createElement("script");
l.src=e+"js/module/"+a[f];l.async=!0;l.onload=l.onreadystatechange=function(){k+=1;k==a.length&&d(c.appName).appEventManager.dispatchGMEvent(h.GMEvent(b,c))};document.body.appendChild(l)}},request:function(a,c,b,e){if(FlaGallery&&FlaGallery.ajaxurl){var d=this,f=new XMLHttpRequest;f.open("POST",FlaGallery.ajaxurl,!0);f.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8");f.setRequestHeader("X-Requested-With","XMLHttpRequest");f.setRequestHeader("Access-Control-Allow-Headers",
"Content-Type, Access-Control-Allow-Headers, Authorization, X-Requested-With");f.onreadystatechange=function(){4==this.readyState&&(200!=this.status?b&&d.moduleSettings(c.appName).appEventManager.dispatchGMEvent(d.GMEvent(b,c,{error:this.statusText,params:e})):b&&d.moduleSettings(c.appName).appEventManager.dispatchGMEvent(d.GMEvent(b,c,{data:this.responseText,params:e})))};f.onerror=function(d){1==confirm("Failed to load resource: The network connection was lost. Let's try again?")&&request(a,c,b,
e)};try{f.send(a),d.moduleSettings(c.appName).appEventManager.dispatchGMEvent(d.GMEvent(m.REQUEST_START,c,null))}catch(l){d.trace(l)}}},Item:function(a,c){var b={get webView(){if(this.webImg.src)return b.webImg;this.webImg.src=this.itemViewSrc;return this.webImg}};this.copyProperties(a,b);b.appName=c;b.idPrefix=void 0;b.albums=[];b.categories=[];b.tags=[];b.ID=b.pid;b.comment_status="close";b.title=b.alttext;b.user=void 0;b.webImg=new Image;b.webImgFrame=this.Rect(0,0,0,0);b.webImg.addEventListener("load",
function(){this.classList.add("onLoad")},!1);b.meta=function(){var a={};a.data=b.meta_data;a.mime=b.meta_data.webview.mime;a.likes=b.total_votes;a.views=b.hitcounter;a.original={};a.original.width=b.meta_data.width;a.original.height=b.meta_data.height;a.original.link=b.galleryURL+"/"+b.filename;a.thumb={};a.thumb.width=b.meta_data.thumbnail.width;a.thumb.height=b.meta_data.thumbnail.height;a.thumb.link=b.galleryURL+"/thumbs/thumbs_"+b.filename;a.web={};a.web.width=b.meta_data.webview["0"];a.web.height=
b.meta_data.webview["1"];a.web.link=b.galleryURL+"/webview/"+b.filename;return a}();if(b.link&&""!=b.link){a=b.link;var e;a.match(/youtu\.be/i)||a.match(/youtube\.com/i)?(c=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&\?]*).*/,(a=a.match(c))&&11==a[7].length&&(e=a[7]),void 0!==e&&(b.meta.mime="video/youtube",b.videoId=e,b.link=void 0)):a.match(/vimeo\.com/i)&&(c=/(www\.)?vimeo.com\/(\d+)($|\/)/,(a=a.match(c))&&(e=a[2]),void 0!==e&&(b.meta.mime="video/vimeo",b.videoId=e,b.link=
void 0))}b.mime_type=b.meta.mime;"audio/mpeg"==b.mime_type&&(b.type="audio");"image"==b.mime_type.split("/")[0]&&(b.type="image");"video"==b.mime_type.split("/")[0]&&(b.type="video");b.hasTag=function(a){if("all"==a)return!0;if(!b.tags||0==b.tags.length)return!1;for(var c=0;c<b.tags.length;c++)if(b.tags[c].term_id==a)return!0};b.itemViewSrc=b.meta?b.meta.web&&"gif"!=b.mime_type.split("/")[1]?b.meta.web.link:b.meta.original?b.meta.original.link:null:null;b.url=b.share_link=b.itemViewSrc;b.itemViewThumbSrc=
b.meta?b.meta.thumb?b.meta.thumb.link:b.meta.web?b.meta.web.link:null:null;b.itemViewSize=b.meta?b.meta.web?h.Size(b.meta.web.width,b.meta.web.height):b.meta.original?h.Size(b.meta.original.width,b.meta.original.height):h.Size(300,300):h.Size(300,300);b.itemViewThumbSize=b.meta?b.meta.thumb?h.Size(b.meta.thumb.width,b.meta.thumb.height):b.meta.web?h.Size(b.meta.web.width,b.meta.web.height):h.Size(300,300):h.Size(300,300);return b},Term:function(a,c){var b={indexByID:function(a){for(var b=0;b<this.itemsList.length;b++)if(this.itemsList[b].ID==
a)return b;return 0},taxony_type:"gallery"};b.appName=c;b.taxonomy="albums";b.itemsList=[];b.user=void 0;this.copyProperties(a,b);a=b.gallery.title?b.gallery.title:void 0;b.title=a;b.name=b.title;a=b.gallery.gid?b.gallery.gid:void 0;b.term_id=a;if(b.data&&0<b.data.length)for(a=0;a<b.data.length;a++){b.data[a].galleryURL=b.gallery.path;var e=this.Item(b.data[a],c);e.tags.push({name:b.name,term_id:b.term_id});e.index=a;b.itemsList.push(e)}b.meta||(a=this.Meta({},b.appName),a._cover=b.itemsList[0]?b.itemsList[0]:
void 0,b.meta=a);b.count=b.itemsList.length;a=b.gallery.galdesc?b.gallery.galdesc:void 0;b.description=a;c=this.moduleSettings(c).post_url?this.moduleSettings(c).post_url:void 0;b.sharelink=c;c=0<b.itemsList.length?b.itemsList[0].itemViewSrc:void 0;b.thumbnail=c;return b},Meta:function(a,c){var b={get cover(){return b._cover?b._cover:null}};this.copyProperties(a,b);b.appName=c;b._cover&&(b._cover=this.Item(a._cover,b.appName));return b}};var w=["fla_vit_slider.js","fla_vit_itemMenu.js","fla_vit_modalWin.js?ver=2.1.0"],
h=new r,x=h.trace,d=h.moduleSettings,m={REQUEST_START:"REQUEST_START",COLLECTION_DATA_REDY:"COLLECTION_DATA_REDY",COUNTERS_UPDATED:"COUNTERS_UPDATED",NEED_MODAL:"NEED_MODAL",NEED_LIGHTBOX:"NEED_LIGHTBOX",REMOVE_LIGHTBOX:"REMOVE_LIGHTBOX",NEED_NEW_COLLECTION:"NEED_NEW_COLLECTION",NEED_PREV_COLLECTION:"NEED_PREV_COLLECTION",NEED_NEW_COLLECTION_BY_TERM:"NEED_NEW_COLLECTION_BY_TERM",FULLSCREEN_SWITCH:"FULLSCREEN_SWITCH"};t.prototype={updateView:function(){for(var a=this.delegate.tagsCloud,c=0;c<a.length;c++){var b=
a[c];document.getElementById(this.id+b.id)||(b=this.createTag(b.id,b.name),this.list.appendChild(b))}this.selectedTag=document.getElementById(this.id+this.delegate.filtredById);this.selectedTag.style.backgroundColor=d(this.appName).tagCloudTextColor;this.selectedTag.style.color=d(this.appName).tagCloudBgColor;this.selectedTag.style.cursor="default"},createTag:function(a,c){function b(a){var b=this.id.split("_")[this.id.split("_").length-1];if(e.selectedTag!=this)switch(a.type){case "click":e.selectedTag=
document.getElementById(e.id+e.delegate.filtredById);e.selectedTag.style.color=d(e.appName).tagCloudTextColor;e.selectedTag.style.backgroundColor=d(e.appName).tagCloudBgColor;e.selectedTag.style.cursor="pointer";e.delegate.filtred(b);e.selectedTag=document.getElementById(e.id+e.delegate.filtredById);e.selectedTag.style.cursor="default";break;case "mouseenter":this.style.backgroundColor=d(e.appName).tagCloudTextColor;this.style.color=d(e.appName).tagCloudBgColor;break;case "mouseleave":this!=e.selectedTag&&
(this.style.color=d(e.appName).tagCloudTextColor,this.style.backgroundColor=d(e.appName).tagCloudBgColor)}}var e=this,k=document.createElement("li");k.innerHTML=c;k.id=this.id+a;k.style.color=d(this.appName).tagCloudTextColor;k.style.backgroundColor=d(this.appName).tagCloudBgColor;k.addEventListener("click",b,!1);k.addEventListener("mouseenter",b,!1);k.addEventListener("mouseleave",b,!1);return k}};u.prototype={init:function(){function a(a){if(d(f.appName).lightBoxEnable)switch(a.type){case "mouseenter":this.classList.add("fla_hover");
h&&h.classList.add("fla_hover");break;case "mouseleave":this.classList.remove("fla_hover");h&&h.classList.remove("fla_hover");break;case "click":this.classList.remove("fla_hover"),h&&h.classList.remove("fla_hover"),f.delegate.itemAction(f.index,"lightBox")}}function c(a){a.classList.remove("fla_hover");"like"==a.getAttribute("type")&&a.getAttribute("like")||"bookmark"==a.getAttribute("type")&&a.getAttribute("mark")?a.style.backgroundColor=p:(a.style.backgroundColor=p,a.childNodes[0].style.fill=m)}
function b(a){"click"==a.type?e&&(f.delegate.itemAction(f.index,this.getAttribute("type")),miniScreen&&c(this)):"mouseenter"==a.type?(this.classList.add("fla_hover"),this.style.backgroundColor=q,"bookmark"==this.getAttribute("type")&&this.getAttribute("mark")||(this.childNodes[0].style.fill=r)):"mouseleave"==a.type&&c(this)}var e=this.delegate.itemsList[this.index];this.item=e;var k=this.delegate.itemWidth;this.type=e.type;this.itemViewSrc=!1;this.img=new Image;var f=this;this.img.onload=function(){this.setAttribute("alt",
e.title);1.1<f.view.clientWidth/this.naturalWidth&&e.itemViewSrc&&!f.itemViewSrc&&(this.src=e.itemViewSrc,f.itemViewSrc=!0);f.imageHolder.style.minHeight=null;this.style.opacity="1"};this.imageHolder.appendChild(this.img);if(d(this.appName).lightBoxEnable){var h=document.createElement("div");h.className="fla_imageOver";h.style.backgroundColor=d(this.appName).collectionThumbHoverColor;this.imageHolder.appendChild(h);var g=document.createElement("div");g.className="fla_zoom";switch(this.item.type){case "video":"vimeo"==
this.item.mime_type.split("/")[1]?(g.classList.add("media"),g.innerHTML='<svg enable-background="new 0 0 56.693 56.693" height="56.693px" id="Layer_1" version="1.1" viewBox="0 0 56.693 56.693" width="56.693px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M3.602,22.974l2.01,2.636c0,0,4.146-3.267,5.528-1.634c1.382,1.634,6.656,21.357,8.417,24.997  c1.537,3.192,5.777,7.413,10.426,4.397c4.646-3.014,20.098-16.205,22.863-31.781c2.764-15.574-18.594-12.313-20.854,1.256  c5.652-3.395,8.671,1.38,5.778,6.784c-2.889,5.399-5.527,8.921-6.908,8.921c-1.379,0-2.441-3.612-4.021-9.928  c-1.635-6.53-1.624-18.291-8.416-16.958C12.019,12.921,3.602,22.974,3.602,22.974z"/></svg>',
g.firstChild.style.fill="#00adef"):(g.classList.add("media"),g.innerHTML='<svg data-name="Layer 21" height="24" id="Layer_21" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><title/><path d="M21.80731,7.805a2.79915,2.79915,0,0,0-2.54907-2.53906C17.69061,5.13586,15.36707,5,12.50012,5c-3.45251,0-6.05865.14105-7.74353.27332A2.79932,2.79932,0,0,0,2.1925,7.815C2.08936,8.90021,2,10.33344,2,12.0423c0,1.66632.08862,3.07422.19128,4.14594a2.79852,2.79852,0,0,0,2.56384,2.53833C6.43994,18.85883,9.04657,19,12.50012,19c2.86694,0,5.19049-.13586,6.75812-.266a2.799,2.799,0,0,0,2.54907-2.539C21.91052,15.11548,22,13.69189,22,12S21.91052,8.88452,21.80731,7.805ZM9.77594,14.93878V9.06122L15.574,12Z"/></svg>',
g.firstChild.style.fill="#e02f2f");break;case "audio":g.classList.add("media");g.innerHTML='<svg version="1.1" viewBox="0 0 58 94" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><g><path d="M37.992,0h-8.021v65.358c-4.435-1.706-10.174-1.73-15.835,0.328C3.994,69.377-2.049,78.355,0.638,85.736   c2.688,7.383,13.088,10.374,23.229,6.683c8.614-3.134,14.249-10.082,14.111-16.626l0.014-53.451   c13.986,2.204,14.943,19.884,13.268,24.842c-0.636,1.879,0.484,3.286,2.598,0C68.938,23.726,37.992,13.376,37.992,0z"/></g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/></svg>';
g.firstChild.style.fill="#7a7a7a";break;default:g.innerHTML='<svg fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><polyline points="15 3 21 3 21 9"/><polyline points="9 21 3 21 3 15"/><line x1="21" x2="14" y1="3" y2="10"/><line x1="3" x2="10" y1="21" y2="14"/></svg>'}this.imageHolder.appendChild(g)}this.imageHolder.addEventListener("mouseenter",a,!1);this.imageHolder.addEventListener("mouseleave",
a,!1);this.imageHolder.addEventListener("click",a,!1);this.img.src=1.1<k/e.itemViewThumbSize.width?e.itemViewSrc:e.itemViewThumbSrc;this.imageRetio=e.itemViewSize.height/e.itemViewSize.width;this.imageHolder.style.minHeight=this.imageRetio*k+"px";k=document.createElement("div");k.className="fla_itemContent";k.style.backgroundColor=d(this.appName).collectionThumbContentBGColor;this.view.appendChild(k);g=void 0;d(this.appName).collectionThumbTitleShow&&e.title&&""!=e.title&&(g=document.createElement("div"),
g.className="fla_itemTitle",g.style.fontSize=d(this.appName).collectionThumbFontSize+"px",g.style.color=d(this.appName).collectionThumbTitleColor,g.innerHTML=e.title,k.appendChild(g));d(this.appName).collectionThumbDescriptionShow&&e.description&&""!=e.description&&(g=document.createElement("div"),g.className="fla_itemDescription",g.style.fontSize=d(this.appName).collectionThumbDescriptionFontSize+"px",g.style.color=d(this.appName).collectionThumbDescriptionColor,g.innerHTML=e.description,k.appendChild(g));
g=document.createElement("div");g.className="fla_itemMenuHolder";var m=d(this.appName).collectionThumbSubMenuIconColor,p=d(this.appName).collectionThumbSubMenuBackgroundColor,q=d(this.appName).collectionThumbSubMenuBackgroundColorOver,r=d(this.appName).collectionThumbSubMenuIconHoverColor;if(e.link){var n=document.createElement("a");n.className="fla_itemReadMore";n.innerHTML=d(this.appName).collectionReadMoreButtonLabel;n.style.backgroundColor=d(this.appName).collectionReadMoreButtonBGColor;n.style.color=
d(this.appName).collectionReadMoreButtonLabelColor;n.setAttribute("target",d(this.appName).linkTargetWindow);n.setAttribute("href",e.link);n.onmouseenter=function(){this.style.backgroundColor=d(f.appName).collectionReadMoreButtonBGColorHover;this.style.color=d(f.appName).collectionReadMoreButtonLabelColorHover};n.onmouseleave=function(){this.style.backgroundColor=d(f.appName).collectionReadMoreButtonBGColor;this.style.color=d(f.appName).collectionReadMoreButtonLabelColor};n.addEventListener("click",
b,!1);g.appendChild(n)}0<g.childNodes.length&&k.appendChild(g);0==k.childNodes.length&&(k.style.display="none")},resize:function(a){return this.view.clientHeight},updateSomeData:function(){},set mark(a){this.bookmarkButton&&(a?(this.bookmarkButton.getElementsByTagName("svg")[0].style.fill="red",this.bookmarkButton.setAttribute("mark","true")):(this.bookmarkButton.getElementsByTagName("svg")[0].style.fill=this.bookmarkButton.classList.contains("fla_hover")?d(this.appName).collectionThumbSubMenuIconHoverColor:
d(this.appName).collectionThumbSubMenuIconColor,this.bookmarkButton.removeAttribute("mark")))},get mark(){return this.bookmarkButton?!0:!1},set like(a){this.likeButton&&(a?(this.likeButton.getElementsByTagName("svg")[0].style.fill="red",this.likeButton.style.cursor="default",this.likeButton.style.pointerEvents="none",this.likeButton.setAttribute("like","true")):(this.likeButton.childNodes[0].style.fill=this.iconColor,this.likeButton.style.cursor="pointer",this.likeButton.style.pointerEvents="all",
this.likeButton.removeAttribute("like")))},get like(){return this.likeButton?!0:!1},set visibility(a){this.view.style.visibility=a},set display(a){"none"==a&&clearTimeout(this.opacityDelay);this._display=this.view.style.display=a;this.updateSomeData()},get display(){return this._display},set opacity(a){var c=this;a.delay?this.opacityDelay=setTimeout(function(){c.view.style.opacity=a.opacity},a.delay):(clearTimeout(this.opacityDelay),c.view.style.opacity=a.opacity)}};p.prototype={init:function(){this.showPreloader(!0)},
initData:function(){this.showPreloader(!1);var a={};a.backgroundColor=d(this.appName).collectionThumbSubMenuBackgroundColor;a.backgroundColorOver=d(this.appName).collectionThumbSubMenuBackgroundColorOver;a.iconColor=d(this.appName).collectionThumbSubMenuIconColor;a.iconColorOver=d(this.appName).collectionThumbSubMenuIconHoverColor;this.itemMenu=this.delegate.itemMenuConstructor(this.delegate,h,a,!1);this.gallery=this.delegate.gallery;this.dataLoaded()},showPreloader:function(a){var c=void 0;if(a)document.getElementById(this.appName+
"_preloader")||(c=h.createPreloaderView(h.hexToRgbaStrin(d(this.appName).collectionPreloaderColor,.7)),c.id=this.appName+"_preloader",this.view.appendChild(c));else if(document.getElementById(this.appName+"_preloader")){var b=this;c=document.getElementById(this.appName+"_preloader");h.fadeOut(c,function(){b.view&&b.view.removeChild(c)},500)}},dataLoaded:function(){this.addItemsToCollection(this.gallery);this.updateViewByData();d(this.appName).lightBoxEnable&&this.delegate.startItem&&this.tryOpenLightboxForID(this.delegate.startItem)},
tryOpenLightboxForID:function(a){if(this.filteredCollection)for(var c=0;c<this.filteredCollection.length;c++)if(this.filteredCollection[c].ID==a)return d(this.appName).appEventManager.dispatchGMEvent(h.GMEvent(m.NEED_LIGHTBOX,this,{collection:this,index:c})),!0;return!1},addItemsToCollection:function(a){this.createTagsCloud();for(var c=0;c<a.length;c++){var b=a[c];b.index=c;this.itemsList.push(b)}},trySortItemsByTerms:function(){this.queryTermsList=h.termsListFromAppQuery(this.query);if(this.itemsList&&
this.queryTermsList){for(var a=[],c=0;c<this.queryTermsList.length;c++)for(var b=this.queryTermsList[c],e=0;e<this.itemsList.length;e++){var d=this.itemsList[e];if(d[b.taxonomy_type]){var f=d[b.taxonomy_type],l;for(l in f)f[l].term_id==b.term_id&&(a.push(d),this.itemsList.splice(e,1),--e)}}this.itemsList=a.concat(this.itemsList)}},itemAction:function(a,c){if(!this.dragging){var b=this.filteredCollection[a];switch(c){case "lightBox":d(this.appName).appEventManager.dispatchGMEvent(h.GMEvent(m.NEED_LIGHTBOX,
this,{collection:this,index:a}));break;case "share":d(this.appName).appEventManager.dispatchGMEvent(h.GMEvent(m.NEED_MODAL,self,{type:"share",item:b}));break;case "link":b.link&&window.open(b.link,d(this.appName).linkTargetWindow);break;case "coments":window.open(b.sharelink+"/#comments",d(this.appName).linkTargetWindow);break;case "like":this.delegate.likeItem=b;break;case "bookmark":this.delegate.bookmarkItem=b}}},refteshDataInItem:function(){for(var a=0;a<this.filteredCollection.length;a++)this.filteredCollection[a].view.updateSomeData()},
activate:function(){this.updateLayout();(this.scrollHandler=this.scrollHandlerFunction())&&window.addEventListener("scroll",this.scrollHandler,!1)},deactivate:function(){d(this.appName).appEventManager.removeGMEventListener(m.COLLECTION_DATA_REDY,this,"dataLoaded");window.removeEventListener("scroll",this.scrollHandler,!1);this.scrollHandler=void 0;this.removePresentedItems()},removeItemViewFormStage:function(){this.removePresentedItems();this.presentedList=[];this.cureantPage=void 0},removePresentedItems:function(){for(var a=
0;a<this.presentedList.length;a++)this.presentedList[a].display="none"},showPresentedItems:function(){for(var a=0;a<this.presentedList.length;a++)this.presentedList[a].display="block"},createLayout:function(){this.scrollHandler||(this.scrollHandler=this.scrollHandlerFunction())&&window.addEventListener("scroll",this.scrollHandler,!1);this.page_Amount=Math.min(20,this.filteredCollection.length)},updateLayout:function(){},scrollHandlerFunction:function(){return!1},resize:function(){var a=this;clearTimeout(this.resizeTimeOut);
h.is_touch_device?this.resizeTimeOut=setTimeout(function(){a.resizeDelay()},150):this.resizeDelay()},resizeDelay:function(){this.viewWidth!=this.view.clientWidth&&(this.updateLayout(),this.viewWidth=this.view.clientWidth)},createTagsCloud:function(){if(this.tagsCloud){var a={},c=[];if(this.delegate.terms.albums.itemsList){var b;for(b=0;b<this.delegate.terms.albums.itemsList.length;b++){var e=this.delegate.terms.albums.itemsList[b];d(this.appName).tagsSortingByName?(c.push(e.name),a[e.name]=b):this.tagsCloud.push({name:e.name,
id:e.term_id})}if(d(this.appName).tagsSortingByName)for(c.sort(),b=0;b<c.length;b++)e=this.delegate.terms.albums.itemsList[a[c[b]]],this.tagsCloud.push({name:e.name,id:e.term_id})}}},set filtredById(a){if(this.itemsList&&(this.filteredList=[],this._filter=a,0!==a))for(var c=0;c<this.itemsList.length;c++){var b=this.itemsList[c];b.hasTag(a)&&this.filteredList.push(b)}},get filtredById(){return this._filter},get filteredCollection(){return 0<this.filteredList.length?this.filteredList:this.itemsList},
filtred:function(a){window.removeEventListener("scroll",this.scrollHandler,!1);this.scrollHandler=void 0;this.removeItemViewFormStage();this.filtredById=a;this.createLayout()},updateTagsCloud:function(){0!=this.filteredCollection.length&&(this.tagsCloudView||(this.tagsCloudView=new t(this),this.header.appendChild(this.tagsCloudView.view)),this.tagsCloud&&this.tagsCloudView.updateView())}};q.prototype=Object.create(p.prototype,{updateViewByData:{value:function(){if(this.itemsList)for(var a=0;a<this.itemsList.length;a++){var c=
new u(this,a);this.itemsList[a].view=c;c.init()}d(this.appName).tagsFilter&&this.updateTagsCloud();this.createLayout()}},createLayout:{value:function(){p.prototype.createLayout.apply(this,arguments);this.createColumns();this.addPageToStage()}},updateLayout:{value:function(){if(0==this.createColumns())this.presentedList&&this.presentedList[0]&&"none"==this.presentedList[0].display&&this.showPresentedItems();else{this.removePresentedItems();for(var a=0;a<this.presentedList.length;a++)this.arangeItemToColum(this.presentedList[a])}}},
createColumns:{value:function(){var a=Math.floor(this.content.clientWidth/Math.min(this.content.clientWidth,d(this.appName).collectionThumbRecomendedWidth));if(this.columnsArr.length!=a){for(var c=0;c<this.columnsArr.length;c++)this.content.removeChild(this.columnsArr[c]);this.columnsArr=[];for(c=0;c<a;c++){var b=document.createElement("div");b.className="collectionColumn";b.style.width=100/a+"%";this.columnsArr.push(b);this.content.appendChild(b)}return!0}return!1}},bottomSpace:{get:function(){return this.content.getBoundingClientRect().bottom-
window.innerHeight}},scrollHandlerFunction:{value:function(a){var c=this;return function(){200>c.bottomSpace&&c.addPageToStage()}}},addPageToStage:{value:function(){void 0===this.cureantPage&&(this.cureantPage=0);clearTimeout(this.layoutSizerDelay);if(!(this.cureantPage>=Math.ceil(this.filteredCollection.length/this.page_Amount))){for(var a=this.cureantPage*this.page_Amount,c=Math.min(a+this.page_Amount,this.filteredCollection.length),b=1;a<c;a++){var e=this.filteredCollection[a].view;e.index=a;e.opacity=
{opacity:0,delay:0};this.addItemToStage(e);e.opacity={opacity:1,delay:100*b};b+=1}this.cureantPage+=1;var d=this;this.layoutSizerDelay=setTimeout(function(){200>d.bottomSpace&&d.addPageToStage()},1E3)}}},getColumWithMinHeight:{value:function(){for(var a=this.columnsArr[0].clientHeight,c=0,b=1;b<this.columnsArr.length;b++)a!=Math.min(a,this.columnsArr[b].clientHeight)&&(a=Math.min(a,this.columnsArr[b].clientHeight),c=b);return c}},arangeItemToColum:{value:function(a){var c=a.view;this.columnsArr[this.getColumWithMinHeight()].appendChild(c);
a.display="block"}},addItemToStage:{value:function(a){this.arangeItemToColum(a);this.presentedList.push(a)}},itemWidth:{get:function(){var a=Math.floor(this.content.clientWidth/d(this.appName).collectionThumbRecomendedWidth);return this.content.clientWidth/a}}});q.prototype.constructor=q;v.prototype={modulesReady:function(a){"function"===typeof window.fla_v2_masonry_itemMenu&&(this.itemMenuConstructor=window.fla_v2_masonry_itemMenu);"function"===typeof window.fla_v2_masonry_slider&&(this.sliderConstructor=
window.fla_v2_masonry_slider);"function"===typeof window.fla_v2_masonry_modalWin&&(this.modalConstructor=window.fla_v2_masonry_modalWin);d(this.appName).appEventManager.removeGMEventListener(m.EXT_SCRIPTS_READY,this,"modulesReady");this.startApp()},get itemFromHash(){var a=window.location.hash.indexOf(this.appName),c=void 0;a+1&&(c=2<=window.location.hash.substr(a).split("-").length?parseInt(window.location.hash.substr(a).split("-")[1]):void 0);return c},itemHash:function(a){return"#"+this.appName+
"-"+a.ID},startApp:function(){var a=this;d(this.appName).key=!0;d(this.appName).appEventManager.addGMEventListener(m.NEED_NEW_COLLECTION,this,"pushNewCollectionByTermID");d(this.appName).appEventManager.addGMEventListener(m.NEED_NEW_COLLECTION_BY_TERM,this,"pushNewCollectionByTerm");d(this.appName).appEventManager.addGMEventListener(m.NEED_MODAL,this,"createModal");d(this.appName).lightBoxEnable&&(d(this.appName).appEventManager.addGMEventListener(m.NEED_LIGHTBOX,this,"createLightbox"),d(this.appName).appEventManager.addGMEventListener(m.REMOVE_LIGHTBOX,
this,"removeLightbox"));this.viewsSet={};d(this.appName).appEventManager.addGMEventListener(m.COUNTERS_UPDATED,this,"itemsCountersUpdateHandler");this.likesSet={};window.localStorage.getItem("fla_likesSet")&&(this.likesSet=JSON.parse(window.localStorage.getItem("fla_likesSet")));window.addEventListener("resize",function(){a.windowResizeHandler(a)});this.popstateHandler=function(b){a.slider?a.slider.prepareToRemove():a.collection&&a.itemFromHash&&(a.collection.tryOpenLightboxForID(a.itemFromHash)||
window.history.replaceState("",document.title,window.location.pathname+window.location.search))};window.addEventListener("popstate",this.popstateHandler,!1);if(this.data&&0<this.data.length){this.terms.albums={};this.terms.albums.itemsList=[];for(var c=0;c<this.data.length;c++){var b=h.Term(this.data[c],this.appName);this.terms.albums.itemsList.push(b);this.gallery=this.gallery.concat(b.itemsList)}this.collection.initData();this.openItemFormHashStartApp()}else x("Error - data is empty")},openItemFormHashStartApp:function(){var a=
this.itemFromHash;a&&this.collection&&(window.history.replaceState("",document.title,window.location.pathname+window.location.search),this.collection.tryOpenLightboxForID(a))},set likeItem(a){a&&(a.meta.likes||(a.meta.likes=0),a.meta.likes=parseInt(a.meta.likes)+1,a=a.ID,this.likesSet[a]||(this.likesSet[a]="like",this.viewsSet[a]&&delete this.viewsSet[a],a="action=flagallery_update_counters&json="+JSON.stringify({likes:[a],views:[a]}),h.request(a,this,m.COUNTERS_UPDATED),window.localStorage.setItem("fla_likesSet",
JSON.stringify(this.likesSet))))},set viewItem(a){var c=a.ID;this.updateItemLink(a);this.viewsSet[c]="view"},itemsCountersUpdate:function(){if(this.viewsSet){var a=[];for(key in this.viewsSet)a.push(key);0<a.length&&(a="action=flagallery_update_counters&json="+JSON.stringify({likes:[],views:a}),h.request(a,this,m.COUNTERS_UPDATED),this.viewsSet={})}},itemsCountersUpdateHandler:function(a){},createLightbox:function(a){if(a.params||a.params.collection||this.sliderConstructor){var c=a.params.collection;
a=a.params.index;var b=c.filteredCollection[a];this.slider&&this.slider.prepareToRemove();window.localStorage.getItem("fla_likesSet")&&(this.likesSet=JSON.parse(window.localStorage.getItem("fla_likesSet")));this.slider=this.sliderConstructor(this,h);this.slider.initByList(c.filteredCollection,a);c="#"+this.appName+"-"+b.ID;window.location.hash!=c&&window.history.pushState(null,null,c)}},updateItemLink:function(a){window.history.replaceState(null,null,this.itemHash(a))},removeLightbox:function(a){var c=
this,b=a.target;setTimeout(function(){b.view&&b.view.parentNode&&b.view.parentNode.removeChild(b.view);c.slider&&(c.slider=void 0)},400);this.itemFromHash&&window.history.back()},createModal:function(a){if(a.params.type&&a.params.item&&this.modalConstructor){var c=a.params.item;this.modal||(this.modal=this.modalConstructor(this,h));this.modal.type=a.params.type;var b=void 0;switch(a.params.type){case "share":b=this.modal.shareBar;break;case "info":b=this.modal.infoBar}b.item=c;this.modal.pushPage(b.view)}},
deleteModal:function(){this.modal&&delete this.modal},windowResizeHandler:function(a){this.collection&&this.collection.resize();this.slider&&this.slider.resizeHandler()}};(function(){window.addEventListener("load",function(){for(var a=document.body.getElementsByClassName("amron_skin"),c=0;c<a.length;c++){var b=a[c].id;this[b]=new v(this[b],b,a[c])}})})()}fla_amron_module();
